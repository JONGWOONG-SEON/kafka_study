# 카프카 설치

### 주키퍼 역할
1. 브로커 메타데이터 관리
    - 어떤 브로커가 클러스터에 포함되어 있는지
    - 각 브로커의 상태를 추적
2. 리더 선출
    - Kafka 파티션은 각 파티션마다 리더를 가진다
    - 주키퍼는 각 파티션의 리더 브로커를 선출하고 관리
3. Configuration 관리
    - Kafka의 설정 정보(토픽, 파티션)를 중앙에서 관리
    - 브로커와 클라이언트가 설정 정보를 가져오는데 사용
4. 클러스터링 상태 모니터링
    - 카프카 브로커들이 살아 있는지 확인
    - 장애가 발생한 브로커의 파티션을 다른 브로커로 재배치

### 주키퍼의 한계와 Kraft도입
- 간소화된 아키텍쳐: 주키퍼 의존성 제거
- 더 나은 성능: 데이터 변경 및 리더 선출에 더 빠른 반응
- 쉬운 운영: 카프카와 주키퍼를 따로 관리할 필요가 없음

### 브로커 설정하기
> 브로커의 설정은 주로 Kafka의 설정 파일(server.properties)에 관리
- broker.id
    - 클러스터 내 모든 브로커는 고유한 broker.id를 가져야 함
    - 기본값: 0
- listener
    - 브로커가 클라이언트와 통신할 주소와 프로토콜
    - listeners=PLAINTEXT://:9092
        - PLAINTEXT: 기본 프로토콜
        - SSL: 암호화된 통신
        - SASL: 인증 추가 기능
- zookeeper.connect(Zookeeper 기반 운영 시)
    - listeners=PLAINTEXT://:9092
    - cf.chroot를 사용하는 이유?
        - 주키퍼 앙상블을 공유해서 사용 가능
        - 특정 서버에 장애가 생기더라도 같은 주키퍼 앙상블의 다른 서버에 연결 할 수 있기 때문에
- log.dir
    - 브로커가 메시지를 저장하는 경로
    - 여러 경로는 쉼표로 구분하여 설정 가능
